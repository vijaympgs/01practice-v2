4.3 Purchase Order (PO)
Template Ref: _txn_03 (Medium/Complex Transaction)
4.3.1 Business Purpose
The Purchase Order (PO) is the legally binding commercial document issued to a supplier, confirming agreed quantities, prices, taxes, delivery terms, and payment terms.
Goals:
Convert approved internal demand (PR) and/or awarded vendor quotes (RFQ) into a formal purchase commitment.


Serve as the anchor document for subsequent processes:


Advance Shipment Notice (ASN)


Goods Receipt Note (GRN)


Supplier Invoice Matching


Supplier Returns


Payment & Settlement


Enforce procurement and financial controls:


Budget control (optional integration)


Approval workflows (value/role/category-based)


Vendor, tax, and contract compliance


Support both:


Organizations using PR → RFQ → PO


Organizations using PR → PO directly


Organizations using PO directly (PR & RFQ disabled)


Hybrid behavior (config-driven):
PO may be:


Created directly (no PR/RFQ) for simple procurement.


Created from PR (single or multiple PRs).


Created from RFQ award (pre-populated pricing & terms).


Config rules can enforce:


po_requires_pr for certain categories/locations.


po_requires_rfq above spend thresholds.


Separate approval tiers for Capex vs Opex vs Services.
4.3.2 Data Model
A) PO Header (purchase_order)
Field
Type
Required
Description
id
UUID
Yes
Primary key
company_id
FK
Yes
Company scope
po_number
String(30)
Yes
Human-readable PO No (per sequence)
po_status
Enum
Yes
DRAFT, PENDING_APPROVAL, APPROVED, SENT_TO_SUPPLIER, PARTIALLY_RECEIVED, FULLY_RECEIVED, CLOSED, CANCELLED
supplier_id
FK (Supplier)
Yes
Supplier to whom PO is issued
supplier_contact_name
String(100)
No
Contact person at supplier
supplier_contact_email
String(200)
No
Email for PO dispatch
ordering_location_id
FK (Location)
Yes
Location/department raising the PO
default_delivery_location_id
FK (Location)
No
Default delivery location for PO lines
currency_code
String(10)
Yes
ISO currency code
po_date
Date
Yes
PO issue date
expected_start_date
Date
No
Services/Capex start date (if applicable)
expected_completion_date
Date
No
For long-running services/projects
payment_terms_code
String(50)
No
Reference to payment terms
incoterms_code
String(20)
No
Incoterms (e.g., EXW, FOB, CIF)
freight_terms
String(100)
No
Who bears freight, any conditions
tax_inclusive
Boolean
Yes
True if prices stored are tax-inclusive
total_gross_amount
Decimal
Yes
Sum of line amounts before discounts/taxes
total_discount_amount
Decimal
Yes
Total discount at header level (if used)
total_tax_amount
Decimal
Yes
Total tax across all lines
total_net_amount
Decimal
Yes
Final payable amount = gross - discounts + tax
linked_rfq_id
FK (RFQ Header)
No
If PO created from RFQ award
linked_rfq_vendor_id
FK (RFQ Vendor)
No
Winning vendor reference (if from RFQ)
created_from_pr_flag
Boolean
Yes
True if PO created from one or more PRs
remarks_internal
Text
No
Internal notes (not sent to supplier)
remarks_to_supplier
Text
No
Free text to appear on PO print/email
approval_required
Boolean
Yes
Derived from config based on value/category
approved_by_user_id
FK (User)
No
User who approved PO
approved_at
DateTime
No
Approval timestamp
cancelled_by_user_id
FK (User)
No
Who cancelled PO
cancelled_at
DateTime
No
Cancelled timestamp
sent_to_supplier_at
DateTime
No
When PO was dispatched to supplier
po_version_no
Integer
Yes
Version number for amendments (start at 1)
is_amendment_of_po_id
FK (PO Header)
No
Reference to original PO for amendments
created_by_user_id
FK (User)
Yes
Creator
created_at
DateTime
Auto


updated_at
DateTime
Auto



Note: po_version_no and is_amendment_of_po_id allow for controlled PO amendments; how amendments are managed is further enforced in workflow and validation.

B) PO Line (purchase_order_line)
Each line = one item/variant/service row on the PO.
Field
Type
Required
Description
id
UUID
Yes
Primary key
purchase_order_id
FK (PO Header)
Yes
Link to PO header
line_number
Integer
Yes
Sequential line number on PO
item_id
FK (Item)
Yes
Parent item (for services, can still be a service item)
item_variant_id
FK (Item Variant)
Yes
SKU reference
description_override
String(255)
No
Line description override (for services/Capex)
uom_id
FK (UOM)
Yes
UOM ordered
ordered_qty
Decimal
Yes
Quantity ordered
received_qty
Decimal
Yes
Default 0; updated from GRN
cancelled_qty
Decimal
Yes
Default 0; qty cancelled
unit_price
Decimal
Yes
Unit price (pre-tax or tax-inclusive based on flag)
discount_percent
Decimal
No
Line-level discount %
discount_amount
Decimal
No
Line-level discount value
tax_percent
Decimal
No
Standard tax rate applied
tax_amount
Decimal
No
Tax amount computed for line
line_gross_amount
Decimal
Yes
Qty × unit_price (before discounts/taxes)
line_net_amount
Decimal
Yes
Gross - discount + tax
delivery_location_id
FK (Location)
No
If differs from header default
required_by_date
Date
No
Required delivery date for this line
pr_line_id
FK (PR Line)
No
PR line reference (if fulfilled from PR)
rfq_vendor_quote_line_id
FK (RFQ Vendor Quote)
No
RFQ line reference (if fulfilled from RFQ)
line_status
Enum
Yes
OPEN, PARTIALLY_RECEIVED, FULLY_RECEIVED, CANCELLED
line_remarks_internal
Text
No
Buyer-only notes
line_remarks_to_supplier
Text
No
Supplier-visible notes (line-level)


C) PO–PR Link (purchase_requisition_po_link)
This was already introduced in 4.1 PR; here we reuse it from the PO perspective.
Fields (same table, used bidirectionally):
Field
Type
Required
Description
id
UUID
Yes
Primary key
pr_line_id
FK (PR Line)
Yes
PR line fulfilled
po_id
FK (PO Header)
Yes
PO header
po_line_id
FK (PO Line)
Yes
PO line created
ordered_qty_from_pr
Decimal
Yes
Quantity ordered from PR line

From PO side:
Whenever a PO line is created from PR line, an entry is created/updated here.


Ensures PR line already_ordered_qty is updated correctly.



D) Config / Control (Conceptual)
Key controls (config / YAML / system params):
po_requires_pr (Company, Location, Category, Threshold)


po_requires_rfq (Company, Category, Threshold)


allow_direct_po_for_categories (list)


over_receive_tolerance_percent (e.g. allow receiving up to +5%)


price_change_tolerance_percent (allowed % above last purchase or RFQ price before requiring approval)


allow_po_amendments_after_grn (Yes/No, and for which fields)


po_approval_thresholds (role-based matrix by value/category)

4.3.3 UI / UX Requirements
Screen Name: Purchase Order
 Path: Procurement → Purchase Order

A) PO List
Columns:
PO Number


PO Date


Supplier


Ordering Location


Status


Total Amount


Linked RFQ (Yes/No or RFQ Number)


Linked PR (Yes/No or count)


Last Updated


Filters:
Date range (PO Date)


Status (DRAFT, PENDING_APPROVAL, APPROVED, SENT_TO_SUPPLIER, etc.)


Supplier


Location


Created By / Approved By


Has RFQ? (Yes/No)


Has PR? (Yes/No)


Actions:
Create PO


Open/Edit PO (depending on status/role)


Submit for Approval


Approve / Reject (for approvers)


Send PO to Supplier (email/PDF/export)


Cancel PO (with reason)


View PO History / Amendments



B) PO Header Form
Sections:
General


PO Number (auto)


PO Date (default to today)


Supplier (lookup)


Supplier Contact Name / Email


Ordering Location


Default Delivery Location


Currency


Commercial Terms


Payment Terms


Incoterms


Freight Terms


Tax Inclusive? (Yes/No)


Expected Start & Completion Dates (for services/Capex)


References


Linked RFQ (if any)


Linked RFQ Round (optional display)


Linked PR(s) (view lines referenced)


Contract/Rate Agreement reference (future enhancement)


Notes


Internal Notes (not printed)


Remarks to Supplier (printed on PO/email)


System Info (read-only)


PO Status


Approval Required? (Yes/No)


Approved By / At


Sent to Supplier At


Version No


Amendment Of (if this is a revised PO)



C) PO Line Entry
Grid behavior:
Columns:
Line No


Item Code / Name lookup


SKU / Variant


Description Override (editable)


UOM


Ordered Qty


Unit Price


Discount %


Line Gross


Tax %


Tax Amount


Line Net


Delivery Location


Required By Date


PR Reference (if from PR)


RFQ Quote Reference (if from RFQ)


Line Status


Features:
Add line:


From Item Master search.


From PR line selection: “Add from PR” (filter by location, status, item).


From RFQ award: “Import from RFQ” picks awarded vendor lines.


Inline validation:


Required fields for item, qty, price, UOM.


Non-zero ordered quantity.


Read-only fields when derived from RFQ:


Optionally lock price & terms if config prohibits price override.


Totals panel at bottom:


Sum of gross, discount, tax, net.



D) Approver View
Approvers see:
Summary header (supplier, amount, category, location).


Risk flags:


Price above last purchase?


Vendor risk rating?


Missing RFQ despite threshold?


Key calculated data:


PO value vs approval limit.


Budget consumption (if budget module integrated).


Actions:
Approve (with optional comment)


Reject (reason required)


Request Clarification (optional intermediate status in future)



E) Supplier-Facing View (Print / PDF / Email)
PO document includes:
Supplier details


PO number and date


Delivery details


Line items with quantities & prices


Taxes & totals


Payment terms & Incoterms


Signature/block text according to company branding


System must support generating:
PDF


Optional email body with attached PDF


Optional export (CSV/Excel) if needed



4.3.4 Validation Rules
Header-level:
po_number unique per company.


supplier_id required and must reference ACTIVE supplier.


ordering_location_id required.


po_date cannot be in the future (configurable rule) or earlier than PR/RFQ dates (for linked documents).


If po_requires_pr is true for this category/location:


At least one line must reference a PR line.


If po_requires_rfq is true (threshold/category-based) and RFQ is enabled:


PO must reference awarded RFQ data, or user must provide a justification comment and optionally follow an elevated approval flow.


Line-level:
At least one line item is required.


ordered_qty > 0.


ordered_qty + cancelled_qty must be ≥ received_qty.


unit_price ≥ 0.


When line is linked to RFQ:


If price_change_tolerance_percent is configured:


PO line price deviation vs RFQ awarded price above tolerance → requires additional approval.


When line is linked to PR:


ordered_qty_from_pr (sum from PO lines) must not exceed requested_qty on PR line.


If line refers to a service item:


required_by_date or expected_completion_date should be present.


Status/Workflow integrity:
Cannot submit for approval when:


Required header fields are missing.


Any line is incomplete.


Cannot approve PO with status not in PENDING_APPROVAL.


Cannot cancel PO if:


Any line is FULLY_RECEIVED (should go through closure process instead).


Cannot edit PO lines once:


GRN exists for that line (only limited fields allowed per config).


Amendment rules:
When PO is amended:


Certain fields (vendor, base currency) may be locked.


Amendments that affect already received quantities may be blocked or require higher approval.



4.3.5 Workflow
Hybrid, config-driven PO lifecycle:
Default state machine:
DRAFT
 → Submit → PENDING_APPROVAL (if approval_required = true)
 → Approve → APPROVED
 → Send to Supplier → SENT_TO_SUPPLIER
 → GRNs posted → PARTIALLY_RECEIVED / FULLY_RECEIVED
 → Close → CLOSED


Alternative paths:
DRAFT → Cancel → CANCELLED


PENDING_APPROVAL → Reject → DRAFT or REJECTED (config)


APPROVED → Cancel (if allowed and no GRN yet) → CANCELLED


Integration with other modules:
PR:


As PO lines referencing PR are created:


purchase_requisition_po_link updated.


PR line statuses updated (OPEN → PARTIALLY_ORDERED → FULLY_ORDERED).


PR header may move from APPROVED → PARTIALLY_ORDERED → FULLY_ORDERED → CLOSED.


RFQ:


Once PO is created from awarded RFQ:


RFQ header may move to AWARDED and eventually CLOSED.


GRN:


GRN lines referencing PO lines update:


received_qty on PO lines.


PO line statuses (OPEN → PARTIALLY_RECEIVED → FULLY_RECEIVED).


PO header status (APPROVED/SENT_TO_SUPPLIER → PARTIALLY_RECEIVED → FULLY_RECEIVED → CLOSED).


Amendments:
Optionally modeled as:


New PO record with is_amendment_of_po_id referencing original.


Version numbers to track revision history.


Original PO may move to a status like SUPERSEDED (future enhancement).



4.3.6 Module Metadata & Build Steps
Module Metadata
module_type: transaction
complexity: medium_to_complex

template_ref: _txn_03

extension_allowed: true

depends_on:
  - Company
  - Locations
  - Item Master
  - Item Variants
  - Units of Measure
  - Suppliers
  - Purchase Requisition (4.1) [optional linkage]
  - Request for Quotation (4.2) [optional linkage]
  - Users / Roles
  - Procurement Configuration

used_by:
  - ASN (4.4)
  - GRN & QC (4.5)
  - Invoice Matching (4.6)
  - Supplier Returns (4.7)
  - Payments & Settlement (4.8)
  - Vendor Performance (4.9)
  - Procurement Analytics


Build Steps (for AI / Implementation Engine)
You are building a Medium-to-Complex Transaction module for a Retail ERP.

Module: Purchase Order (PO)
Template: _txn_03

Requirements:

1) Backend (Django + DRF):

   Models:
   - purchase_order (header)
   - purchase_order_line (lines)
   - Reuse purchase_requisition_po_link table defined in 4.1
     for PR–PO linkage.

   Serializers:
   - Header + nested lines serializer(s).
   - Lightweight list serializer for PO listing.

   Viewsets & Endpoints:
   - CRUD for PO header & lines with appropriate permissions.
   - Workflow actions:
     - submit_po (DRAFT → PENDING_APPROVAL or APPROVED when no approval needed)
     - approve_po (PENDING_APPROVAL → APPROVED)
     - reject_po (PENDING_APPROVAL → DRAFT/REJECTED as per config)
     - cancel_po (allowed from specific statuses)
     - send_to_supplier (marks as SENT_TO_SUPPLIER + triggers PDF/email generation hook)
   - Integration endpoints:
     - Query APPROVED POs for GRN creation.
     - Query POs by PR or RFQ linkage.

   Business Rules:
   - Enforce validation from section 4.3.4.
   - Enforce configuration behavior (po_requires_pr, po_requires_rfq,
     tolerances, amendment rules).
   - Keep `received_qty` updated via GRN integration (referenced later in 4.5).

2) Frontend (React + Vite + Tailwind):

   Screens:
   - PO List:
     - Columns, filters, and actions as defined in UI section.
     - Status color-coding (badges) and quick filters.
   - PO Edit:
     - Tabs/sections for Header, Lines, References, Notes, System Info.
     - Lines grid with:
       - Add line manually
       - Add from PR
       - Add from RFQ (awarded items)
     - Totals panel for gross, discount, tax, net.
   - Approval View:
     - Compact summary of PO header with risk/exception indicators.
     - Approve/Reject actions with comment.

   Behavior:
   - Lock appropriate fields based on status (e.g. cannot edit supplier
     after approval).
   - Show clear indicators when PO came from PR/RFQ (and enforce
     restrictions like price changes above tolerance).
   - Provide “View Source PR” and “View RFQ” links for traceability.

3) Integration:

   - From PR (4.1):
     - APIs to search and select APPROVED PR lines by location/item.
     - When lines imported:
       - Maintain PR–PO link.
       - Update PR line progress.

   - From RFQ (4.2):
     - APIs to fetch AWARDED RFQ lines for a selected supplier.
     - Pre-populate unit prices, quantities, and terms from
       `rfq_vendor_quote_line`.

   - To GRN (4.5):
     - Provide PO lines as source for GRN creation, ensuring remaining
       receivable quantity is correctly calculated.

   - To Invoice Matching (4.6):
     - Provide confirmed PO prices, quantities, and tax flags.

4) Security & Roles:

   - Define distinct roles:
     - PO Creator / Buyer
     - PO Approver
     - PO Viewer
   - Restrict amendment and cancellation actions to appropriate roles.

Ensure the implementation adheres to the data model, workflows,
validation rules, and UI/UX requirements defined in the Purchase Order
specification.
