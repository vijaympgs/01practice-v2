
4.5 Goods Receipt Note (GRN) + Quality Check (QC)
Template Ref: _txn_03 (Medium/Complex Transaction)
4.5.1 Business Purpose
The Goods Receipt Note (GRN) records the actual physical receipt of goods/services against a Purchase Order (and optionally ASN).
 The Quality Check (QC) sub-process validates whether received items meet quality standards.
Goals:
Update inventory with accurate received quantities, batches, and serials.


Support 3-way / 4-way matching (PO ↔ ASN ↔ GRN ↔ Invoice).


Capture accepted vs rejected quantities, reasons, and QC results.


Enable vendor performance and claims (damage, shortage, wrong items).


Provide traceability for batch/expiry/serial items (FMCG, pharma, electronics).


Hybrid behavior (config-driven):
GRN can be created:


Directly from PO (common retail scenario).


From ASN (for advanced inbound flows).


QC can be:


Embedded within GRN (simple)


Separate but linked QC document (for heavy QC flows) — we’ll model QC inline but data model ready for extension.



4.5.2 Data Model
A) GRN Header (goods_receipt_note)
Field
Type
Required
Description
id
UUID
Yes
Primary key
company_id
FK
Yes
Company scope
grn_number
String(30)
Yes
Human-readable GRN No
grn_status
Enum
Yes
DRAFT, POSTED, CANCELLED
supplier_id
FK (Supplier)
Yes
Supplier delivering goods
receiving_location_id
FK (Location)
Yes
Store/Warehouse receiving goods
goods_received_date
Date
Yes
Physical receipt date
linked_po_id
FK (PO Header)
Yes
Primary PO reference (multi-PO via lines allowed)
linked_asn_id
FK (ASN Header)
No
If GRN created from ASN
invoice_number
String(50)
No
Supplier invoice number (if provided at receipt)
invoice_date
Date
No
Supplier invoice date
vehicle_number
String(50)
No
Vehicle/truck number
delivery_document_ref
String(50)
No
Delivery challan / packing list ref
remarks
Text
No
General comments
created_by_user_id
FK (User)
Yes
Who created GRN
posted_by_user_id
FK (User)
No
Who finalized/posted GRN
posted_at
DateTime
No
Posting timestamp
created_at
DateTime
Auto


updated_at
DateTime
Auto




B) GRN Line (goods_receipt_note_line)
Each line represents received quantity for a PO line (potentially partial).
Field
Type
Required
Description
id
UUID
Yes
Primary key
goods_receipt_note_id
FK (GRN Header)
Yes
Parent GRN
purchase_order_line_id
FK (PO Line)
Yes
PO line reference
asn_line_id
FK (ASN Line)
No
If GRN came via ASN
item_id
FK (Item)
Yes
Item master
item_variant_id
FK (Item Variant)
Yes
SKU
uom_id
FK (UOM)
Yes
UOM
received_qty
Decimal
Yes
Total received qty at dock
accepted_qty
Decimal
Yes
Qty accepted into stock
rejected_qty
Decimal
Yes
Qty rejected; must satisfy received_qty = accepted_qty + rejected_qty
putaway_location_id
FK (Location/Bin)
No
Warehouse location/bin (if WMS integrated)
qc_required
Boolean
Yes
Derived from item/category configuration
qc_status
Enum
Yes
NOT_REQUIRED, PENDING, PASSED, FAILED, OVERRIDDEN
rejection_reason_code
String(50)
No
Reason (damage, short expiry, wrong item, etc.)
rejection_remarks
Text
No
Additional comments
batch_number
String(50)
No
Batch/lot number
expiry_date
Date
No
Expiry date for perishable items
serial_numbers_blob
Text
No
JSON/comma-separated serials
line_remarks
Text
No
General line remarks


C) GRN–Inventory Movement (Conceptual)
Actual inventory movement is usually recorded via:
Stock Ledger / Inventory Transaction table (outside this section), using:


accepted_qty to increase stock.


Optionally mark rejected_qty in blocked, return, or scrap location.


We assume:
This module produces inventory movement events to be consumed by Inventory.



D) Config / Control (Conceptual)
grn_requires_po = true/false (no-PO receipts allowed? rarely; mostly false)


grn_allows_without_asn = true/false


qc_required_by_category (e.g. electronics, fresh, pharma)


expiry_must_be_at_least_x_days (min remaining shelf-life)


allow_receive_over_po_percent (tolerance, e.g., 5%)


block_posting_if_qc_pending (true/false per item/category)



4.5.3 UI / UX Requirements
Screen Name: Goods Receipt Note
 Path: Procurement / Inventory → Inbound → GRN

A) GRN List
Columns:
GRN Number


GRN Date


Supplier


Receiving Location


Linked PO Number


Linked ASN (Yes/No or ASN No)


Status


Created By / Posted By


Filters:
Date range (GRN Date)


Supplier


Location


Status (DRAFT, POSTED, CANCELLED)


Linked PO / ASN


Actions:
Create GRN


From PO


From ASN


View / Edit (DRAFT only)


Post GRN


Cancel GRN (with reason)


Print/Export GRN (for internal record)



B) GRN Header Form
Sections:
General


GRN Number (auto)


Goods Received Date


Receiving Location


Supplier (inferred from PO)


Linked PO (required)


Linked ASN (optional)


Invoice Number/Date (if known)


Vehicle / Delivery Document ref


Remarks


System Info


GRN Status


Created By / At


Posted By / At



C) GRN Lines Grid
Columns:
PO Number


PO Line No


Item Code / Name


SKU


UOM


PO Ordered Qty


Previously Received Qty


Remaining Qty


Received Qty (input)


Accepted Qty (input)


Rejected Qty (derived or input)


QC Required?


QC Status


Batch No / Expiry (if applicable)


Rejection Reason


Line Remarks


Features:
Load from:


Selected PO (shows remaining quantities).


Selected ASN (default from ASN shipped_qty).


Auto:


Compute remaining_qty = ordered_qty - total_received_so_far.


Suggest received_qty from ASN (if used).


Inline validations:


Rejected+Accepted = Received.


Remaining quantities not exceeded beyond tolerance.



D) QC Capture (Inline or Side Panel)
For lines with qc_required = true:
QC Status field:


PENDING, PASSED, FAILED, OVERRIDDEN.


QC input fields (conceptual, can be future extended):


QC check list (e.g., packaging, labeling, physical condition).


Measured attributes (weight, dimension, etc.).


QC remarks.


QC done by (user) + date/time.


UI options:
Embedded inline in GRN line editor.


Or QC modal dialog per line.



4.5.4 Validation Rules
Header-level:
grn_number unique per company.


receiving_location_id required.


goods_received_date cannot be in future (configurable).


linked_po_id required unless config allows non-PO GRN.


If linked_asn_id present:


Supplier in ASN must match Supplier in PO.


Location in ASN must match receiving location.


Line-level:
Each GRN must have at least one line.


received_qty > 0.


accepted_qty + rejected_qty = received_qty.


received_qty + previous GRN receipts for that PO line must not exceed:


ordered_qty * (1 + over_receive_tolerance_percent).


QC-level:
If qc_required = true:


If block_posting_if_qc_pending = true:


Cannot POST GRN while any line with QC required has qc_status = PENDING.


For batch-controlled items:


batch_number and expiry_date cannot be null.


expiry_date must be at least today + min_shelf_life_days if configured.


Status/Workflow:
Only DRAFT GRNs can be edited.


POSTED GRN:


Locked except for limited reversal/cancellation logic as per finance/inventory policy.


CANCELLED GRN:


If inventory postings already done, must either:


Post negative adjustment, or


Be blocked — actual reversal handled in separate process.



4.5.5 Workflow
Standard:
DRAFT
 → Post GRN → POSTED (inventory updated)


Alternative:
DRAFT → Cancel → CANCELLED


Integration:
With PO:


On POST:


Increase received_qty on purchase_order_line.


Update PO line status: OPEN → PARTIALLY_RECEIVED → FULLY_RECEIVED.


Update PO header status accordingly (e.g., APPROVED → PARTIALLY_RECEIVED → FULLY_RECEIVED → CLOSED).


With ASN:


If GRN references ASN:


Update ASN line status based on accepted quantities.


When all ASN lines fully received or cancelled, ASN may be set to CLOSED.


With Invoice Matching (4.6):


GRN details feed quantity & QC info for 3-way / 4-way matching.


With Vendor Performance (4.9):


Defect rates, damage reasons, short/over-deliveries all feed into vendor quality KPIs.



4.5.6 Module Metadata & Build Steps
Module Metadata
module_type: transaction
complexity: medium_to_complex

template_ref: _txn_03

extension_allowed: true

depends_on:
  - Company
  - Locations
  - Suppliers
  - Purchase Order (4.3)
  - ASN (4.4) [optional]
  - Users / Roles
  - Item / Variant / UOM
  - Inventory & Stock Ledger (for posting)
  - QC / Quality Rules Config

used_by:
  - Invoice Matching (4.6)
  - Supplier Returns (4.7)
  - Vendor Performance (4.9)
  - Inventory Valuation & Stock Reports


Build Steps (for AI / Implementation Engine)
You are building a Medium-to-Complex Transaction module for a Retail ERP.

Module: Goods Receipt Note (GRN) + Quality Check (QC)
Template: _txn_03

Requirements:

1) Backend (Django + DRF):

   Models:
   - goods_receipt_note (header)
   - goods_receipt_note_line (lines)

   Serializers:
   - GRN header with nested lines.
   - List serializer for GRN listing.

   Viewsets & Endpoints:
   - CRUD for GRN header & lines (DRAFT only).
   - Workflow actions:
     - post_grn (DRAFT → POSTED)
     - cancel_grn (DRAFT → CANCELLED)
   - Integration endpoints:
     - Load PO lines with remaining quantities.
     - Load ASN lines (if GRN created from ASN).

   Business Rules:
   - Enforce quantity validations, tolerance rules, QC dependencies.
   - On POST:
     - Trigger inventory movement events for accepted_qty.
     - Update PO line received_qty and statuses.
     - Update ASN line statuses if linked.

2) Frontend (React + Vite + Tailwind):

   Screens:
   - GRN List:
     - Filters and actions as per spec.
   - GRN Edit:
     - Header form (supplier, PO, dates, documents).
     - Lines grid with:
       - From PO loader.
       - Optionally from ASN.
     - Inline QC flags and fields.

   Behavior:
   - Lock GRN after POST.
   - Clear warnings for over-receipt, missing batch/expiry, QC pending.

3) Integration:

   - Upstream:
     - POs and ASNs as source documents.
   - Downstream:
     - Expose GRN data to Invoice Matching (4.6).
     - Expose QC and rejection reasons to Vendor Performance (4.9).
     - Post inventory movements to Inventory module.

4) Security & Roles:

   - GRN Creator (warehouse/store user).
   - GRN Poster (may be same or different role).
   - GRN Viewer.

Ensure full adherence to the data model, validation rules, and workflow
defined in the GRN + QC specification.

