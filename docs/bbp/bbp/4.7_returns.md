
4.7 Supplier Returns (RTO – Return to Origin)
Template Ref: _txn_03 (Medium Transaction)
4.7.1 Business Purpose
Supplier Returns (RTO) handles returning goods back to the supplier after they have been received, due to:
Quality failures


Damages


Wrong items / over-delivery


Near-expiry or regulatory non-compliance


Goals:
Adjust inventory out of stock back to supplier-return pipeline.


Provide a formal Supplier Return Note / Debit Note basis:


For financial credit


For replacement shipments


Feed back into:


Vendor performance (defect rate, damage rate)


Dispute resolution and claims workflow.


Hybrid behavior (config-driven):
Returns can be:


Immediate at dock (during GRN) or


Post-GRN (identified later during put-away or sales).


May require:


Approval before creating return.


Automatic Debit Note generation.



4.7.2 Data Model
A) Supplier Return Header (supplier_return_note)
Field
Type
Required
Description
id
UUID
Yes
Primary key
company_id
FK
Yes
Company scope
return_number
String(30)
Yes
Human-readable return reference
return_status
Enum
Yes
DRAFT, PENDING_APPROVAL, APPROVED, DISPATCHED, CLOSED, CANCELLED
supplier_id
FK (Supplier)
Yes
Supplier to whom stock is returned
originating_location_id
FK (Location)
Yes
Store/Warehouse returning goods
linked_po_id
FK (PO Header)
No
If known
linked_grn_id
FK (GRN Header)
No
Usually required for stock traceability
return_reason_category
Enum
Yes
QUALITY_FAILURE, DAMAGE, WRONG_ITEM, EXCESS_SUPPLY, OTHERS
reference_document_number
String(50)
No
Could be complaint ref, QC ref, claim ID
remarks_internal
Text
No
Internal remarks (not sent to supplier)
remarks_to_supplier
Text
No
Message printed on return note
approval_required
Boolean
Yes
Controlled by config (value/qty)
approved_by_user_id
FK (User)
No
Approver for return
approved_at
DateTime
No
Approval timestamp
dispatch_date
Date
No
Date goods physically shipped back
carrier_name
String(100)
No
Transporter name for return
vehicle_number
String(50)
No
Vehicle/regn number
return_debit_note_number
String(50)
No
Financial debit note reference (if created)
created_by_user_id
FK (User)
Yes
Who created return
created_at
DateTime
Auto


updated_at
DateTime
Auto




B) Supplier Return Line (supplier_return_note_line)
Each line represents quantity being returned against specific GRN/PO line.
Field
Type
Required
Description
id
UUID
Yes
Primary key
supplier_return_note_id
FK (Return Header)
Yes
Header ref
goods_receipt_note_line_id
FK (GRN Line)
Yes
From which stock was originally received
purchase_order_line_id
FK (PO Line)
No
Optional if needed for financial link
item_id
FK (Item)
Yes
Item master
item_variant_id
FK (Item Variant)
Yes
SKU
uom_id
FK (UOM)
Yes
UOM
received_qty_from_grn
Decimal
Yes
Qty originally received on GRN line
already_returned_qty
Decimal
Yes
Qty previously returned from this GRN line
return_qty
Decimal
Yes
Qty being returned now
batch_number
String(50)
No
Batch/lot (copied from GRN)
expiry_date
Date
No
Same or updated expiry
serial_numbers_blob
Text
No
JSON/comma-separated serial numbers
reason_code
String(50)
Yes
Detailed reason (e.g., DAMAGE_TRANSIT, WRONG_BARCODE)
line_remarks
Text
No
Additional info
line_status
Enum
Yes
PENDING, DISPATCHED, CLOSED, CANCELLED
expected_credit_amount
Decimal
No
Estimated value to be recovered from supplier
final_credit_amount
Decimal
No
Actual credit note amount (once known)


C) Config / Control (Conceptual)
return_requires_grn (true/false; usually true)


return_approval_threshold_amount


return_allowed_time_window_days (e.g., cannot return after X days from GRN)


auto_generate_debit_note (Yes/No; integration with Finance)


return_affects_vendor_score (Yes/No; weight in vendor performance)



4.7.3 UI / UX Requirements
Screen Name: Supplier Returns (RTO)
 Path: Procurement / Inventory → Outbound → Supplier Returns

A) Supplier Return List
Columns:
Return Number


Supplier


Originating Location


Linked GRN Number


Return Reason Category


Status


Dispatch Date


Created By / Approved By


Filters:
Date range (Created, Dispatch)


Supplier


Location


Status


Reason Category


Actions:
Create Return


View/Edit (DRAFT / PENDING_APPROVAL)


Approve / Reject


Mark as Dispatched


Close (when financial reconciliation done)


Cancel (with reason)



B) Supplier Return Header Form
Sections:
General


Return Number (auto)


Supplier


Originating Location


Return Reason Category


Linked GRN


Linked PO (optional)


Reference Document (complaint, QC ticket, etc.)


Remarks (internal & supplier-facing)


Logistics


Dispatch Date


Carrier


Vehicle Number


Financial


Expected Debit Note No. (if pre-planned)


Final Debit Note (once issued by Finance/AP)



C) Supplier Return Lines Grid
Columns:
Item Code / Name


SKU


UOM


GRN Number / GRN Line


Received Qty (from GRN)


Already Returned Qty


Return Qty (input)


Batch / Expiry


Reason Code


Expected Credit Amount


Line Status


Features:
Add lines by:


Selecting from GRN lines (filter by supplier/location/date).


Show warning when:


already_returned_qty + return_qty > received_qty.


For batch/serial items:


Allow selection of specific serials or batch segments.



4.7.4 Validation Rules
Header-level:
return_number unique per company.


supplier_id must match supplier of linked GRN/PO.


originating_location_id must match receiving location of GRN (unless cross-org allowed by config).


If return_requires_grn = true:


At least one linked_grn_id and GRN lines on return.


Line-level:
return_qty > 0.


already_returned_qty + return_qty <= received_qty_from_grn.


For batch-managed items:


batch_number required.


If return_allowed_time_window_days specified:


Check GRN date vs current date; prevent or require override beyond allowed window.


Approval:
If total expected_credit_amount > return_approval_threshold_amount:


Set approval_required = true.


Cannot dispatch until approved.


Status/Workflow:
Cannot mark return DISPATCHED:


If any line has invalid quantity.


If approval_required and not approved.


Cannot close return:


Until financial side processed (either automatically or via manual confirmation).



4.7.5 Workflow
Standard:
DRAFT
 → Submit → PENDING_APPROVAL (if approval_required)
 → Approve → APPROVED
 → Dispatch → DISPATCHED
 → Close (once credit note processed / resolved) → CLOSED


Alternative:
If no approval required:


DRAFT → APPROVED directly on submit.


Cancellation:
DRAFT / PENDING_APPROVAL / APPROVED → CANCELLED (with reason).


After DISPATCHED, cancellation path depends on config and may require reverse movement.


Inventory integration:
On DISPATCH:


Inventory movement event to reduce stock at originating location.


Potential movement to “In-Transit to Supplier” virtual location.


Finance integration:
On CLOSED:


Ensure debit note/credit is linked against supplier account.


Vendor performance:
Each return line contributes to:


Damage rate


Wrong shipment rate


Quality failure metrics.



4.7.6 Module Metadata & Build Steps
Module Metadata
module_type: transaction
complexity: medium

template_ref: _txn_03

extension_allowed: true

depends_on:
  - Company
  - Locations
  - Suppliers
  - GRN & QC (4.5)
  - Purchase Order (4.3) [optional]
  - Inventory Movement Engine
  - Users / Roles
  - Return / Claims Configuration

used_by:
  - Vendor Performance & Compliance (4.9)
  - Inventory Valuation & Stock Adjustments
  - Dispute & Claims Management


Build Steps (for AI / Implementation Engine)
You are building a Medium Transaction module for a Retail ERP.

Module: Supplier Returns (RTO)
Template: _txn_03

Requirements:

1) Backend (Django + DRF):

   Models:
   - supplier_return_note (header)
   - supplier_return_note_line (lines)

   Serializers:
   - Header with nested lines.
   - List serializer for returns.

   Viewsets & Endpoints:
   - CRUD while in DRAFT.
   - Workflow actions:
     - submit_return
     - approve_return
     - reject_return
     - dispatch_return
     - close_return
     - cancel_return

   Business Rules:
   - Enforce quantity validations against GRN lines.
   - Enforce approval and time-window rules.
   - Trigger inventory movement events at dispatch.

2) Frontend (React + Vite + Tailwind):

   Screens:
   - Return List view with filters and status.
   - Return Edit:
     - Header (supplier, location, reasons).
     - Lines grid (select from GRN lines).
     - Logistics info (dispatch details).
   - Approval View with summary of returned amounts.

   Behavior:
   - Block dispatch if not approved where required.
   - Show warnings for over-return or old GRNs.

3) Integration:

   - Upstream:
     - GRN and PO lines as source for return.
   - Downstream:
     - Provide return info to Finance for debit note creation.
     - Feed into Vendor Performance (4.9).
     - Adjust inventory via stock movement.

4) Security & Roles:

   - Return Creator
   - Return Approver
   - Return Dispatcher
   - Return Viewer

Ensure conformance with the data model, workflow, and validation
rules defined in the Supplier Returns specification.

