
4.4 Advance Shipment Notice (ASN)
Template Ref: _txn_03 (Medium Transaction, Optional)
4.4.1 Business Purpose
The Advance Shipment Notice (ASN) is a pre-receipt notification from the supplier indicating what is being shipped, in what quantities, and when it will arrive, usually against one or more Purchase Orders (POs).
Goals:
Improve receiving efficiency at warehouse/store:


Pre-plan space, manpower, and put-away.


Enable pre-validation of shipment contents vs PO:


Identify over/under shipments before physical arrival.


Support integration with:


3PL logistics


EDI-compatible suppliers


Provide an intermediate layer between PO → GRN for:


High-volume distribution centers


Cross-dock operations


Omnichannel fulfillment flows


Hybrid behavior (config-driven):
ASN can be:


Optional: GRN can be created directly from PO.


Mandatory for certain suppliers/categories:


e.g., DC inbound, imports, high-value electronics.


ASN can be:


Created by supplier (via portal/API)


Created by internal user (for manual carriers / simple suppliers)



4.4.2 Data Model
A) ASN Header (advance_shipment_notice)
Field
Type
Required
Description
id
UUID
Yes
Primary key
company_id
FK
Yes
Company scope
asn_number
String(30)
Yes
Human-readable ASN No (own sequence or supplier reference)
asn_status
Enum
Yes
DRAFT, PUBLISHED, IN_TRANSIT, ARRIVED, CANCELLED, CLOSED
supplier_id
FK (Supplier)
Yes
Supplier sending shipment
supplier_asn_ref
String(50)
No
Supplier's ASN/Shipment reference
created_by_user_id
FK (User)
Yes
Creator (internal or system user for supplier portal submissions)
shipment_date
Date
Yes
Date goods left supplier
estimated_arrival_date
Date
Yes
Expected arrival date
ship_from_location
String(200)
No
Supplier/DC origin details
ship_to_location_id
FK (Location)
Yes
Store/warehouse/DC receiving
carrier_name
String(100)
No
Transporter/courier name
vehicle_number
String(50)
No
Truck/vehicle/regn number
tracking_number
String(100)
No
AWB/bill/consignment tracking
total_packages
Integer
No
Number of cartons/pallets
gross_weight_kg
Decimal
No
Total shipment weight
remarks
Text
No
Any notes on shipment
created_from_po_flag
Boolean
Yes
True if ASN derived directly from PO(s)
created_at
DateTime
Auto


updated_at
DateTime
Auto




B) ASN–PO Link (asn_po_link)
Many ASNs can relate to many POs, but typical scenario: ASN for one or more PO(s) for same supplier & destination.
Field
Type
Required
Description
id
UUID
Yes
Primary key
advance_shipment_notice_id
FK (ASN Header)
Yes
ASN reference
purchase_order_id
FK (PO Header)
Yes
Linked PO header


C) ASN Line (asn_line)
Represents item quantities that supplier indicates are being shipped, usually against PO lines.
Field
Type
Required
Description
id
UUID
Yes
Primary key
advance_shipment_notice_id
FK (ASN Header)
Yes
ASN header
purchase_order_line_id
FK (PO Line)
Yes
Linked PO line
item_id
FK (Item)
Yes
Item master
item_variant_id
FK (Item Variant)
Yes
SKU
uom_id
FK (UOM)
Yes
UOM
shipped_qty
Decimal
Yes
Quantity supplier claims is shipped
expected_arrival_date
Date
No
May override header-level ETA
batch_number
String(50)
No
Supplier’s batch if known
expiry_date
Date
No
For perishable/pharma
serial_numbers_blob
Text
No
JSON or comma list (for serialized items)
line_remarks
Text
No
Any line-level comments
line_status
Enum
Yes
OPEN, PARTIALLY_RECEIVED, FULLY_RECEIVED, CANCELLED

Note: The actual received quantity will be recorded at GRN; ASN is a planned or expected quantity.

D) Config / Control (Conceptual)
asn_enabled (Company, Location, Supplier)


asn_mandatory_for_grn (Yes/No per supplier/category)


asn_allow_over_ship_percent (tolerance vs PO ordered_qty)


asn_allow_partial_mapping (ASN may not cover all PO lines)


asn_require_tracking_info (Yes/No)



4.4.3 UI / UX Requirements
Screen Name: Advance Shipment Notice
 Path: Procurement → Inbound → ASN

A) ASN List
Columns:
ASN Number


Supplier


Ship From (optionally display)


Ship To (Location)


Shipment Date


Estimated Arrival Date


Status


Linked PO Count


Total Packages (if captured)


Filters:
Date range (Shipment or ETA)


Status (DRAFT, IN_TRANSIT, ARRIVED, etc.)


Supplier


Location


Linked PO Number


Actions:
Create ASN (from PO)


View/Edit ASN (status-driven)


Mark as In Transit / Arrived


Cancel ASN (with reason)



B) ASN Header Form
Sections:
Shipment Details


ASN Number (auto)


Supplier


Ship From


Ship To Location


Shipment Date


Estimated Arrival Date


Carrier, Vehicle No, Tracking Number


Gross Weight, Total Packages


Remarks


References


Linked POs (multi-select)


From PO search:


Supplier filter


Location filter


Status filter (APPROVED, SENT_TO_SUPPLIER, PARTIALLY_RECEIVED)


System Info (read-only)


ASN Status


Created By / At


Updated At



C) ASN Lines Grid
Columns:
PO Number


PO Line No


Item Code / Name


SKU / Variant


UOM


Ordered Qty (from PO)


Already Shipped Qty (from previous ASNs)


Shipped Qty (current ASN)


Expected Arrival Date


Batch No (optional)


Expiry Date (optional)


Line Remarks


Features:
Add lines by:


Selecting from linked PO lines.


Auto-calc:


Maximum allowed shipped_qty based on:


PO ordered_qty and previous ASN shipped_qty (if controlled by config).


Show warnings:


If shipped_qty > remaining PO qty + tolerance, highlight cell.



4.4.4 Validation Rules
Header-level:
asn_number unique per company.


supplier_id required and must match supplier of the linked PO(s).


ship_to_location_id must match PO delivery location (unless config allows cross-docking).


shipment_date must be <= estimated_arrival_date (basic date sanity).


Line-level:
purchase_order_line_id must reference a valid PO line where:


PO status is APPROVED or SENT_TO_SUPPLIER or PARTIALLY_RECEIVED.


shipped_qty > 0.


If asn_allow_over_ship_percent is configured:


Validate total_shipped_qty_for_po_line ≤ ordered_qty * (1 + tolerance).


For batch-managed items:


If config requires batch/expiry pre-notification, enforce batch_number and expiry_date not null.


Status/Workflow:
Cannot move ASN to IN_TRANSIT without:


At least one line.


Cannot mark ASN ARRIVED without:


Shipment Date and ETA set.


Cannot Cancel ASN:


If already linked to any posted GRN.



4.4.5 Workflow
Default:
DRAFT
 → Publish/Confirm → PUBLISHED
 → Dispatch/Ship → IN_TRANSIT
 → Mark Arrival (optional) → ARRIVED
 → GRN created against ASN → CLOSED (once fully accounted)


Alternative transitions:
DRAFT → Cancel → CANCELLED


PUBLISHED / IN_TRANSIT → Cancel (only if no GRN yet) → CANCELLED


Integration with GRN:
When GRN is created:


User may choose source = PO or source = ASN.


If from ASN:


Default GRN lines are populated from ASN lines.


GRN received quantities can be less than or equal to ASN shipped_qty (and potentially more if physical receipt differs – subject to config).


ASN line status updates to:


PARTIALLY_RECEIVED or FULLY_RECEIVED.


ASN may close when all lines are fully received or cancelled.



4.4.6 Module Metadata & Build Steps
Module Metadata
module_type: transaction
complexity: medium

template_ref: _txn_03

extension_allowed: true

depends_on:
  - Company
  - Locations
  - Suppliers
  - Purchase Order (4.3)
  - Users / Roles
  - Procurement/Inbound Config

used_by:
  - GRN & QC (4.5)
  - Inbound Capacity Planning
  - Vendor Performance (on-time shipment vs ETA)


Build Steps (for AI / Implementation Engine)
You are building a Medium Transaction module for a Retail ERP.

Module: Advance Shipment Notice (ASN)
Template: _txn_03

Requirements:

1) Backend (Django + DRF):

   Models:
   - advance_shipment_notice (header)
   - asn_po_link (ASN to PO mapping)
   - asn_line (item-level shipment details)

   Serializers:
   - ASN header with nested lines.
   - List serializer for ASN listing.

   Viewsets & Endpoints:
   - CRUD for ASN header & lines.
   - Workflow actions:
     - publish_asn
     - mark_in_transit
     - mark_arrived
     - cancel_asn
   - Integration endpoints:
     - Load PO lines for ASN creation (by supplier/location/status).
     - Provide ASN lines as source for GRN creation.

   Business Rules:
   - Enforce supplier/location/PO consistency.
   - Enforce shipped quantity & tolerance rules.

2) Frontend (React + Vite + Tailwind):

   Screens:
   - ASN List:
     - Filters, status badges, actions.
   - ASN Edit:
     - Header form (shipment info, references).
     - Lines grid (linked PO lines, shipped qty).

   Behavior:
   - Lock selected PO(s) and supplier on ASN once lines are added.
   - Provide clear warnings on over-ship attempts.

3) Integration:

   - With Purchase Order:
     - Fetch eligible PO lines for a supplier/location.
   - With GRN:
     - Allow GRN creation by selecting ASN and using its lines as default.

4) Security & Roles:

   - ASN Creator / ASN Editor / ASN Viewer.
   - Restrict cancellation and status changes to appropriate roles.

Ensure strict adherence to the data model, validation, and workflow
rules defined in the ASN specification.

